<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>ĐĂNG KÝ THÔNG TIN POP-MART</title>
    <link rel="stylesheet" href="/css/style.css?v=1.5" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        @font-face {
            font-family: myFirstFont;
            src: url(/fonts/popmart/GMV_DIN_Pro-Light.ttf);
        }

        * {
            font-family: myFirstFont !important;
        }
    </style>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T72KCLV5JP"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-T72KCLV5JP');
    </script>
</head>
<body style="background-image:url('/images/nen-vincom.jpg?v=1.51'); background-size:cover; background-repeat:no-repeat; background-attachment: fixed; ">

    <form id="form1">
        <div class="ConScreen">

            <div style="text-align:center; margin-top:3%">
                <img src="/images/header-popmart.png" style="width:100%; max-width:450px" />
            </div>
            <div class="TieuDe" style="margin-top:10px">
                REGISTRATION FOR QUEUEING NUMBERS TO PURCHASE HOT ITEMS
            </div>
            <div class="TieuDe">
                POP MART VINCOM CENTER BÀ TRIỆU
            </div>
            <div class="ConFields">
                <div class="dvField1">
                    <select name="slNgayBanHang" id="slNgayBanHang" class="myTextBox txtField1">
                        <option value="">-- Chọn ngày --</option>
                        <option value="04/09/2025">04/09/2025</option>
                        <option value="05/09/2025">05/09/2025</option>
                        <option value="06/09/2025">06/09/2025</option>
                    </select>
                </div>
                <div class="dvField1">
                    <select name="slPhien" id="slPhien" class="myTextBox txtField1">
                        <option value="">-- Chọn phiên --</option>
                        <option value="S1">Sáng</option>
                        <option value="S2">Chiều</option>
                    </select>
                </div>
                <div class="dvField">
                    <input type="text" placeholder="Họ và tên*" class="myTextBox txtField" id="txtHoTen" />
                </div>

                <div class="dvField" style="width:23.5%">
                    <input type="text" placeholder="Ngày sinh*" class="myTextBox txtField" id="dobD" />
                </div>
                <div class="dvField" style="width:23.5%">
                    <input type="text" placeholder="Tháng sinh*" class="myTextBox txtField" id="dobM" />
                </div>

                <div class="dvField">
                    <input type="text" placeholder="Năm sinh*" class="myTextBox txtField" id="dobY" />
                </div>


                <div class="dvField">
                    <input type="text" placeholder="Số điện thoại*" class="myTextBox txtField" id="txtPhone" />
                </div>
                <div class="dvField">
                    <input type="text" placeholder="Email*" class="myTextBox txtField" id="txtEmail" />
                </div>
                <div class="dvField1">
                    <input type="text" placeholder="CCCD/CMND/PASSPORT*" class="myTextBox txtField1" id="txtCCCD" />
                </div>

                <div class="dvField1" style="text-align:left; padding-left:10px">
                    <div style="display:inline-block">
                        <canvas id="canvas" width="200" height="50" style="border: 1px solid #d3d3d3; vertical-align:middle"></canvas>

                    </div>
                    <div style="display:inline-block; vertical-align:middle">
                        <input type="text" id="txtCaptcha" placeholder="Nhập mã captcha*" class="myTextBox" style="width: 150px !important; display: inline-block" />
                    </div>
                </div>

                <div class="dvField1" style="text-align:left; padding-left:10px">
                    <input type="checkbox" id="cbDongY" /> Tôi đồng ý với các điều khoản
                </div>
                <div class="dvField1" style="margin-top:20px">
                    <input type="button" class="MyButton" style="width:100%" value="ĐĂNG KÝ" onclick="fnSubmit();" />
                </div>
            </div>
            <div class="LuotThamGia" style="margin-top:15px; display:none" id="dvSoLuot">
                Đã có <span id="spanSoLuot"></span> lượt đăng ký thành công
            </div>
        </div>
    </form>
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script>
        var char = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',
            'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',
            '0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];

        var captcha = "";

        window.onload = function () {
            fnCheckTrung();
            fnLoadLuot();
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext("2d");
            // tô màu cho captcha
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, 200, 50);

            // vẽ captcha
            for (var i = 0; i < 6; i++) {
                var index = Math.floor(Math.random() * char.length);
                var text = char[index];
                captcha += text;
                ctx.font = "30px Arial";
                ctx.fillStyle = "black";
                ctx.fillText(text, 20 + i * 25, 35);
            }
        }
        function fnCheckTrung() {
            var xmlhttp;
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            }
            else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

                    if (xmlhttp.responseText.trim() != "OK") {
                        alert(xmlhttp.responseText.trim());
                        window.location.href = "https://popmartstt.com/";
                    }
                }
            }
            xmlhttp.open("GET", "/Ajax.aspx?Action=CheckTrung", true);
            xmlhttp.send();
        }

        function fnLoadLuot() {
            var xmlhttp;
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            }
            else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    if (xmlhttp.responseText.trim() != "") {
                        $("#dvSoLuot").css("display", "");
                        $("#spanSoLuot").html(xmlhttp.responseText.trim());
                    }
                }
            }
            xmlhttp.open("GET", "/Ajax.aspx?Action=LoadLuot", true);
            xmlhttp.send();
        }

        function fnSubmit() {
            var NgayBanHang = $("#slNgayBanHang").val();
            if (NgayBanHang == "") {
                alert("Vui lòng chọn ngày tham gia");
                return;
            }
            var Phien = $("#slPhien").val();
            if (Phien == "") {
                alert("Vui lòng chọn phiên tham gia");
                return;
            }
            var HoTen = $("#txtHoTen").val();
            if (HoTen == "") {
                alert("Vui lòng nhập họ tên");
                return;
            }
            var Ngay = $("#dobD").val();
            if (Ngay == "") {
                alert("Vui lòng nhập ngày sinh");
                return;
            }
            var Thang = $("#dobM").val();
            if (Thang == "") {
                alert("Vui lòng nhập tháng sinh");
                return;
            }
            var Nam = $("#dobY").val();
            if (Nam == "") {
                alert("Vui lòng nhập năm sinh");
                return;
            }
            var Phone = $("#txtPhone").val();
            if (Phone == "") {
                alert("Vui lòng nhập số điện thoại");
                return;
            }
            var Email = $("#txtEmail").val();
            if (Email == "") {
                alert("Vui lòng nhập email");
                return;
            }
            var CCCD = $("#txtCCCD").val();
            if (CCCD == "") {
                alert("Vui lòng nhập CCCD");
                return;
            }
            var Captcha = $("#txtCaptcha").val();
            if (Captcha == "") {
                alert("Vui lòng nhập captcha");
                return;
            }
            if (Captcha != captcha) {
                alert("Mã captcha không đúng");
                return;
            }

            if ($('#cbDongY').is(":checked") == false) {
                alert("Vui lòng đồng ý với điều khoản");
                return;
            }


            var xmlhttp;
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            }
            else {// code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            var params = "{'NgayBanHang':'" + NgayBanHang + "', 'HoTen':'" + HoTen + "', 'Ngay':'" + Ngay + "', 'Thang':'" + Thang + "', 'Nam':'" + Nam + "', 'Phone':'" + Phone + "', 'Email':'" + Email + "', 'CCCD':'" + CCCD + "', 'Captcha':'" + Captcha + "', 'Phien':'" + Phien + "'}";
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

                    if (xmlhttp.responseText.trim().toUpperCase() == "OK") {
                        alert("Đăng ký thành công");
                        window.location.href = "https://popmartstt.com/";
                    }
                    else {
                        alert(xmlhttp.responseText.trim());
                    }
                }
            }
            xmlhttp.open("POST", "/Ajax.aspx?Action=Submit", true);
            xmlhttp.setRequestHeader("Content-type", "application/json; charset=utf-8");
            xmlhttp.send(params);
        }
    </script>
</body>
</html>
